var L=Object.defineProperty,T=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var O=(t,n,e)=>n in t?L(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,z=(t,n)=>{for(var e in n||(n={}))F.call(n,e)&&O(t,e,n[e]);if(M)for(var e of M(n))U.call(n,e)&&O(t,e,n[e]);return t},E=(t,n)=>T(t,D(n));import{_ as $,o as _,c as p,p as W,a as Y,b as v,d as j,t as S,e as q,r as y,f as A,g as I,w as H,F as B,h as P,n as V,i as J,j as K,k as Q,l as X,m as Z,q as k,s as ee}from"./entry-87bcafe1.mjs";const te={},N=t=>(W("data-v-57a00e42"),t=t(),Y(),t),ne=N(()=>v("h1",null,"Nuxt 3 Gallery",-1)),oe=N(()=>v("p",null,"Masonry Gallery implementation with Vue Composition API and Nuxt 3",-1)),ae=N(()=>v("p",null,[v("a",{href:"https://github.com/uixprt/nuxt3Gallery"},"See Source Code on GitHub")],-1)),se=[ne,oe,ae];function re(t,n){return _(),p("header",null,se)}var le=$(te,[["render",re],["__scopeId","data-v-57a00e42"]]);const ce=j({props:{url:String,title:String,id:Number},setup(t,{expose:n}){n();const a={props:t};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),ue=["src"];function ie(t,n,e,a,i,d){return _(),p("figure",null,[v("img",{src:e.url,alt:"{{title}}"},null,8,ue),v("figcaption",null,[v("span",null,S(e.id)+") "+S(e.title),1)])])}var de=$(ce,[["render",ie],["__scopeId","data-v-04c351f0"]]);const _e=j({props:{columnWidth:{default:400},items:null,gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0}},emits:["redraw","redraw-skip"],setup(t,{expose:n,emit:e}){n();const a=t,{columnWidth:i,items:d,gap:c,rtl:l,ssrColumns:o}=q(a),m=y([]),f=y();function w(){const r=Math.floor((f.value.getBoundingClientRect().width+c.value)/(i.value+c.value));return r>0?r:1}function h(r){return[...new Array(r)].map(()=>[])}if(o.value>0){const r=h(o.value);d.value.forEach((x,C)=>r[C%o.value].push(C)),m.value=r}async function g(r){if(r>=d.value.length)return;await Q();const x=[...f.value.children];l.value&&x.reverse();const C=x.reduce((R,G)=>G.getBoundingClientRect().height<R.getBoundingClientRect().height?G:R);m.value[+C.dataset.index].push(r),await g(r+1)}async function s(r=!1){if(m.value.length===w()&&!r){e("redraw-skip");return}m.value=h(w());const x=window.scrollY;await g(0),window.scrollTo({top:x}),e("redraw")}const u=new ResizeObserver(()=>s());A(()=>{s(),u.observe(f.value)}),I(()=>u.unobserve(f.value)),H([d,l],()=>s(!0)),H([i,c],()=>s());const b={props:a,columnWidth:i,items:d,gap:c,rtl:l,ssrColumns:o,columns:m,wall:f,emit:e,columnCount:w,createColumns:h,fillColumns:g,redraw:s,resizeObserver:u};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),pe=["data-index"];function me(t,n,e,a,i,d){return _(),p("div",{ref:"wall",class:"masonry-wall",style:V({display:"flex",gap:`${a.gap}px`})},[(_(!0),p(B,null,P(a.columns,(c,l)=>(_(),p("div",{key:l,class:"masonry-column","data-index":l,style:V({display:"flex","flex-basis":0,"flex-direction":"column","flex-grow":1,height:["-webkit-max-content","-moz-max-content","max-content"],gap:`${a.gap}px`})},[(_(!0),p(B,null,P(c,o=>(_(),p("div",{key:o,class:"masonry-item"},[J(t.$slots,"default",{item:a.items[o],index:o},()=>[K(S(a.items[o]),1)])]))),128))],12,pe))),128))],4)}var fe=$(_e,[["render",me]]);const he=j({async setup(t,{expose:n}){n();let e,a;const i=[100,210,320];function d(s){return s.map(u=>{const b=`250x${i[Math.floor(Math.random()*i.length)]}.webp`,r=u.url.replace("600",b);return E(z({},u),{url:r})})}const c=(s,u=25)=>`https://jsonplaceholder.typicode.com/photos?_start=${s*u}&_limit=${u}`;async function l(s){const u=await fetch(c(s));return d(await u.json())}const o=y(0),m=y(([e,a]=X(()=>l(o.value)),e=await e,a(),e));async function f(){if(o.value>=3)return;o.value++,console.log("append",o.value);const s=await l(o.value);console.log("append",o.value,s),m.value.push(...s),console.log(m.value)}const w=y(null);A(()=>{window.addEventListener("scroll",h)}),Z(()=>{window.removeEventListener("scroll",h)});const h=s=>{w.value.getBoundingClientRect().bottom<window.innerHeight&&f()},g={placeholderPhotoHeights:i,formatPhotos:d,url:c,loadPhotos:l,page:o,photos:m,append:f,scrollComponent:w,handleScroll:h};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),ve={ref:"scrollComponent"};function we(t,n,e,a,i,d){const c=de,l=fe;return _(),p("div",ve,[k(l,{items:a.photos,"ssr-columns":1,"column-width":250,gap:10},{default:ee(({item:o,index:m})=>[k(c,{url:o.url,title:o.title,id:o.id},null,8,["url","title","id"])]),_:1},8,["items"]),(_(!0),p(B,null,P(a.photos,o=>(_(),p("div",null,S(o.id),1))),256))],512)}var ge=$(he,[["render",we]]);const xe={components:{}},ye={class:"container"};function $e(t,n,e,a,i,d){const c=le,l=ge;return _(),p("div",ye,[k(c),k(l)])}var Se=$(xe,[["render",$e]]);export{Se as default};
