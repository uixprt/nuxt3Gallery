var W=Object.defineProperty,F=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var M=(n,t,e)=>t in n?W(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,T=(n,t)=>{for(var e in t||(t={}))D.call(t,e)&&M(n,e,t[e]);if(H)for(var e of H(t))Y.call(t,e)&&M(n,e,t[e]);return n},j=(n,t)=>F(n,A(t));import{u as q,_ as V}from"./Header-192e2b21.mjs";import{_ as S,d as N,o as f,c as J,w as z,a as $,t as k,n as B,b as K,e as Q,r as b,f as G,g as X,h as U,i as h,F as E,j as L,k as Z,l as I,m as ee,p as te,q as ne,s as C,u as ae}from"./entry-e7d9d266.mjs";const oe=N({props:{thumbnailUrl:String,title:String,id:Number,height:Number},setup(n,{expose:t}){t();const e={};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}}),re=["src"];function se(n,t,e,a,l,i){const r=K;return f(),J(r,{to:`/photo/${e.id}`},{default:z(()=>[$("figure",{style:B({minHeight:`${e.height-4}px`})},[$("img",{src:e.thumbnailUrl,alt:"{{title}}"},null,8,re),$("figcaption",null,[$("span",null,k(e.id)+") "+k(e.title),1)])],4)]),_:1},8,["to"])}var le=S(oe,[["render",se],["__scopeId","data-v-150232a5"]]);const ie=N({props:{columnWidth:{default:400},items:null,gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0}},emits:["redraw","redraw-skip"],setup(n,{expose:t,emit:e}){t();const a=n,{columnWidth:l,items:i,gap:r,rtl:c,ssrColumns:o}=Q(a),u=b([]),_=b();function w(){const s=Math.floor((_.value.getBoundingClientRect().width+r.value)/(l.value+r.value));return s>0?s:1}function v(s){return[...new Array(s)].map(()=>[])}if(o.value>0){const s=v(o.value);i.value.forEach((y,x)=>s[x%o.value].push(x)),u.value=s}async function p(s){if(s>=i.value.length)return;await I();const y=[..._.value.children];c.value&&y.reverse();const x=y.reduce((O,R)=>R.getBoundingClientRect().height<O.getBoundingClientRect().height?R:O);u.value[+x.dataset.index].push(s),await p(s+1)}async function d(s=!1){if(u.value.length===w()&&!s){e("redraw-skip");return}u.value=v(w());const y=window.scrollY;await p(0),window.scrollTo({top:y}),e("redraw")}const m=new ResizeObserver(()=>d());G(()=>{d(),m.observe(_.value)}),X(()=>m.unobserve(_.value)),U([i,c],()=>d(!0)),U([l,r],()=>d());const g={props:a,columnWidth:l,items:i,gap:r,rtl:c,ssrColumns:o,columns:u,wall:_,emit:e,columnCount:w,createColumns:v,fillColumns:p,redraw:d,resizeObserver:m};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),ce=["data-index"];function ue(n,t,e,a,l,i){return f(),h("div",{ref:"wall",class:"masonry-wall",style:B({display:"flex",gap:`${a.gap}px`})},[(f(!0),h(E,null,L(a.columns,(r,c)=>(f(),h("div",{key:c,class:"masonry-column","data-index":c,style:B({display:"flex","flex-basis":0,"flex-direction":"column","flex-grow":1,height:["-webkit-max-content","-moz-max-content","max-content"],gap:`${a.gap}px`})},[(f(!0),h(E,null,L(r,o=>(f(),h("div",{key:o,class:"masonry-item"},[Z(n.$slots,"default",{item:a.items[o],index:o},()=>[ee(k(a.items[o]),1)])]))),128))],12,ce))),128))],4)}var _e=S(ie,[["render",ue]]);const P=[100,210,320];function de(n){return n.map(t=>{const e=P[Math.floor(Math.random()*P.length)],a=`250x${e}.webp`,l=t.thumbnailUrl.replace("150",a);return j(T({},t),{thumbnailUrl:l,height:e})})}const me=N({async setup(n,{expose:t}){t();let e,a;const l="https://jsonplaceholder.typicode.com/",i=25,r=b(0),{data:c,refresh:o}=([e,a]=te(()=>q(()=>`photos?_start=${r.value*i}&_limit=${i}`,{baseURL:l,transform:de})),e=await e,a(),e),u=b(null);function _(){r.value!==3&&(r.value++,o())}function w(){r.value=0,o()}U(()=>c.value,(m,g)=>{if(r.value===0){u.value=m;return}g&&m!==g&&(u.value=[...u.value,...m])});const v=b(null);G(()=>{window.addEventListener("scroll",p)}),ne(()=>{window.removeEventListener("scroll",p)});const p=async m=>{v.value.getBoundingClientRect().bottom<window.innerHeight&&_()},d={base_url:l,limit:i,page:r,data:c,refresh:o,photos:u,next:_,reset:w,scrollComponent:v,handleScroll:p};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),fe={key:0,ref:"scrollComponent"};function pe(n,t,e,a,l,i){const r=le,c=_e;return a.photos?(f(),h("div",fe,[C(c,{items:a.photos,"column-width":250,gap:10},{default:z(({item:o})=>[C(r,{class:"item",thumbnailUrl:o.thumbnailUrl,title:o.title,id:o.id,height:o.height},null,8,["thumbnailUrl","title","id","height"])]),_:1},8,["items"])],512)):ae("",!0)}var he=S(me,[["render",pe]]);const ve={},ge={class:"container"};function we(n,t){const e=V,a=he;return f(),h("div",ge,[C(e),C(a)])}var $e=S(ve,[["render",we]]);export{$e as default};
